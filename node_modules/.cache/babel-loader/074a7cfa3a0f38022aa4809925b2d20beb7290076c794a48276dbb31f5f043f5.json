{"ast":null,"code":"import React,{useEffect,useState,useRef}from\"react\";import{collection,getDocs,doc,updateDoc,serverTimestamp}from\"firebase/firestore\";import{db,auth}from\"../firebase\";import{format,differenceInDays}from\"date-fns\";import Chart from\"chart.js/auto\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OverallDashboard=()=>{const[clients,setClients]=useState([]);const[selectedClient,setSelectedClient]=useState(\"\");const[rbts,setRbts]=useState([]);const[filtered,setFiltered]=useState([]);const[loading,setLoading]=useState(true);const[userRole,setUserRole]=useState(\"user\");const[filters,setFilters]=useState({site:\"\",running_status:\"\",breakdown_status:\"\",work:\"\",from:\"\",to:\"\"});const chartRef=useRef(null);const runningStatusOptions=[{value:\"Auto\",label:\"Auto\"},{value:\"Manual\",label:\"Manual\"},{value:\"Not Running\",label:\"Not Running\"},{value:\"N/A\",label:\"N/A\"}];const breakdownStatusOptions=[{value:\"Breakdown\",label:\"Breakdown\"},{value:\"Running With Issue\",label:\"Running With Issue\"},{value:\"N/A\",label:\"N/A\"}];const workOptions=[{value:\"Part Installation\",label:\"Part Installation\"},{value:\"Part Testing\",label:\"Part Testing\"},{value:\"Trial\",label:\"Trial\"},{value:\"Auto Scheduling\",label:\"Auto Scheduling\"},{value:\"N/A\",label:\"N/A\"}];// ✅ Fetch user role\nuseEffect(()=>{const fetchRole=()=>{const user=auth.currentUser;if(!user||!user.email)return;if(user.email===\"dev@brightbots.in\")setUserRole(\"super_admin\");else if(user.email.endsWith(\"@brightbots.in\"))setUserRole(\"admin\");else setUserRole(\"user\");};fetchRole();},[]);// ✅ Fetch all clients\nuseEffect(()=>{const fetchClients=async()=>{try{const snapshot=await getDocs(collection(db,\"clients\"));setClients(snapshot.docs.map(doc=>({id:doc.id,...doc.data()})));}catch(err){console.error(\"Error fetching clients:\",err);}};fetchClients();},[]);// ✅ Fetch all RBTs for selected client\nuseEffect(()=>{if(!selectedClient)return;let interval;const fetchAllRBTs=async()=>{try{setLoading(true);const sitesSnapshot=await getDocs(collection(db,\"clients\",selectedClient,\"sites\"));let allRbts=[];for(const siteDoc of sitesSnapshot.docs){const siteName=siteDoc.id;const rbtsSnapshot=await getDocs(collection(db,\"clients\",selectedClient,\"sites\",siteName,\"rbts\"));const siteRbts=rbtsSnapshot.docs.map(docItem=>{var _rbt$last_updated,_rbt$last_updated$toD;const rbt=docItem.data()||{};const lastUpdated=(rbt===null||rbt===void 0?void 0:(_rbt$last_updated=rbt.last_updated)===null||_rbt$last_updated===void 0?void 0:(_rbt$last_updated$toD=_rbt$last_updated.toDate)===null||_rbt$last_updated$toD===void 0?void 0:_rbt$last_updated$toD.call(_rbt$last_updated))||null;return{id:docItem.id,rbt_id:docItem.id,site:siteName,...rbt,running_status:rbt.running_status||\"N/A\",breakdown_status:rbt.breakdown_status||\"N/A\",work:rbt.work||\"N/A\",last_updated:lastUpdated,running_status_ageing:rbt.running_status===\"Auto\"?0:lastUpdated?Math.max(differenceInDays(new Date(),lastUpdated),0):\"-\"};});allRbts=[...allRbts,...siteRbts];}setRbts(allRbts);setFiltered(allRbts);}catch(error){console.error(\"Error fetching RBTs:\",error);}finally{setLoading(false);}};fetchAllRBTs();interval=setInterval(fetchAllRBTs,30000);return()=>clearInterval(interval);},[selectedClient]);// ✅ Apply filters\nuseEffect(()=>{let result=[...rbts];if(filters.site)result=result.filter(rbt=>rbt.site===filters.site);if(filters.running_status)result=result.filter(rbt=>rbt.running_status===filters.running_status);if(filters.breakdown_status)result=result.filter(rbt=>rbt.breakdown_status===filters.breakdown_status);if(filters.work)result=result.filter(rbt=>rbt.work===filters.work);if(filters.from){const fromDate=new Date(filters.from);if(!isNaN(fromDate))result=result.filter(rbt=>rbt.last_updated&&rbt.last_updated>=fromDate);}if(filters.to){const toDate=new Date(filters.to);if(!isNaN(toDate))result=result.filter(rbt=>rbt.last_updated&&rbt.last_updated<=toDate);}setFiltered(result);},[filters,rbts]);// ✅ Chart updates\nuseEffect(()=>{const ctx=document.getElementById(\"statusChart\");if(!ctx)return;if(chartRef.current)chartRef.current.destroy();const counts={Auto:0,Manual:0,\"Not Running\":0};filtered.forEach(rbt=>{if(counts.hasOwnProperty(rbt.running_status))counts[rbt.running_status]++;});chartRef.current=new Chart(ctx,{type:\"line\",data:{labels:Object.keys(counts),datasets:[{label:\"Running Status\",data:Object.values(counts),borderColor:\"#2563eb\",backgroundColor:\"rgba(37, 99, 235, 0.3)\",tension:0.4,fill:true}]},options:{responsive:true,plugins:{tooltip:{enabled:true},legend:{display:false}},scales:{y:{beginAtZero:true,title:{display:true,text:\"No. of RBTs\"}},x:{title:{display:true,text:\"Running Status\"}}}}});},[filtered]);const handleFilterChange=e=>setFilters(prev=>({...prev,[e.target.name]:e.target.value}));const handleExportCSV=()=>{const headers=[\"Site\",\"RBT\",\"Running Status\",\"Breakdown Status\",\"Work\",\"Ageing\",\"Last Updated\"];const rows=filtered.map(rbt=>[rbt.site,rbt.rbt_id,rbt.running_status,rbt.breakdown_status,rbt.work,rbt.running_status_ageing,rbt.last_updated?format(rbt.last_updated,\"yyyy-MM-dd HH:mm\"):\"-\"]);const escapeCSV=val=>`\"${String(val||\"\").replace(/\"/g,'\"\"')}\"`;const csvContent=[headers,...rows].map(row=>row.map(escapeCSV).join(\",\")).join(\"\\n\");const blob=new Blob([csvContent],{type:\"text/csv;charset=utf-8;\"});const url=URL.createObjectURL(blob);const link=document.createElement(\"a\");link.href=url;link.setAttribute(\"download\",`RBT_Dashboard_${Date.now()}.csv`);document.body.appendChild(link);link.click();document.body.removeChild(link);};const handleEditField=async(rbtId,site,field,value)=>{try{const ref=doc(db,\"clients\",selectedClient,\"sites\",site,\"rbts\",rbtId);const now=new Date();const updateData={[field]:String(value),last_updated:serverTimestamp()};if(field===\"running_status\"){updateData.running_status_ageing=value===\"Auto\"?0:0;}await updateDoc(ref,updateData);setRbts(prev=>prev.map(r=>r.id===rbtId?{...r,...updateData,last_updated:now,running_status_ageing:field===\"running_status\"?value===\"Auto\"?0:0:r.running_status_ageing}:r));}catch(error){console.error(\"Error updating field:\",error);}};const totalRBTs=filtered.length;const autoCount=filtered.filter(r=>r.running_status===\"Auto\").length;const manualCount=filtered.filter(r=>r.running_status===\"Manual\").length;const notRunningCount=filtered.filter(r=>r.running_status===\"Not Running\").length;return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold mb-6\",children:\"\\uD83D\\uDCCA Overall RBT Dashboard\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsxs(\"select\",{value:selectedClient,onChange:e=>setSelectedClient(e.target.value),className:\"border p-2 rounded-md\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Client\"}),clients.map(client=>/*#__PURE__*/_jsx(\"option\",{value:client.id,children:client.id},client.id))]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-100 p-4 rounded shadow text-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold\",children:\"Total RBTs\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold\",children:totalRBTs})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-green-100 p-4 rounded shadow text-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold\",children:\"Auto\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold\",children:autoCount})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-yellow-100 p-4 rounded shadow text-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold\",children:\"Manual\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold\",children:manualCount})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-100 p-4 rounded shadow text-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold\",children:\"Not Running\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold\",children:notRunningCount})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"select\",{name:\"site\",value:filters.site,onChange:handleFilterChange,className:\"border p-2 rounded-md\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Filter by Site\"}),Array.from(new Set(rbts.map(rbt=>rbt.site))).filter(v=>v).map(val=>/*#__PURE__*/_jsx(\"option\",{value:val,children:val},val))]}),/*#__PURE__*/_jsxs(\"select\",{name:\"running_status\",value:filters.running_status,onChange:handleFilterChange,className:\"border p-2 rounded-md\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Filter by Running Status\"}),runningStatusOptions.map(opt=>/*#__PURE__*/_jsx(\"option\",{value:opt.value,children:opt.label},opt.value))]}),/*#__PURE__*/_jsxs(\"select\",{name:\"breakdown_status\",value:filters.breakdown_status,onChange:handleFilterChange,className:\"border p-2 rounded-md\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Filter by Breakdown Status\"}),breakdownStatusOptions.map(opt=>/*#__PURE__*/_jsx(\"option\",{value:opt.value,children:opt.label},opt.value))]}),/*#__PURE__*/_jsxs(\"select\",{name:\"work\",value:filters.work,onChange:handleFilterChange,className:\"border p-2 rounded-md\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Filter by Work\"}),workOptions.map(opt=>/*#__PURE__*/_jsx(\"option\",{value:opt.value,children:opt.label},opt.value))]}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"from\",value:filters.from,onChange:handleFilterChange,className:\"border p-2 rounded-md\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"to\",value:filters.to,onChange:handleFilterChange,className:\"border p-2 rounded-md\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(\"button\",{onClick:handleExportCSV,className:\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\",children:\"Export CSV\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2/4 mx-auto mb-10 transition-transform duration-300 hover:scale-110\",children:/*#__PURE__*/_jsx(\"canvas\",{id:\"statusChart\",height:\"200\"})}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading RBT data...\"}):/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white shadow-md rounded-lg\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"bg-gray-200 text-gray-600 uppercase text-sm\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left\",children:\"Site\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left\",children:\"RBT\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left\",children:\"Running\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left\",children:\"Breakdown\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left\",children:\"Work\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left\",children:\"Ageing\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left\",children:\"Last Updated\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"text-gray-700 text-sm\",children:filtered.map(rbt=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b border-gray-200 hover:bg-gray-100\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4\",children:rbt.site}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4\",children:rbt.rbt_id}),[\"running_status\",\"breakdown_status\",\"work\"].map(field=>/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4\",children:userRole===\"admin\"||userRole===\"super_admin\"?/*#__PURE__*/_jsxs(\"select\",{value:rbt[field]||\"N/A\",onChange:e=>handleEditField(rbt.id,rbt.site,field,e.target.value),className:\"border p-1 rounded\",children:[field===\"running_status\"&&runningStatusOptions.map(opt=>/*#__PURE__*/_jsx(\"option\",{value:opt.value,children:opt.label},opt.value)),field===\"breakdown_status\"&&breakdownStatusOptions.map(opt=>/*#__PURE__*/_jsx(\"option\",{value:opt.value,children:opt.label},opt.value)),field===\"work\"&&workOptions.map(opt=>/*#__PURE__*/_jsx(\"option\",{value:opt.value,children:opt.label},opt.value))]}):rbt[field]||\"N/A\"},field)),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4 text-center\",children:rbt.running_status_ageing}),/*#__PURE__*/_jsx(\"td\",{className:\"py-2 px-4\",children:rbt.last_updated?format(rbt.last_updated,\"yyyy-MM-dd HH:mm\"):\"-\"})]},rbt.id))})]})})]});};export default OverallDashboard;","map":{"version":3,"names":["React","useEffect","useState","useRef","collection","getDocs","doc","updateDoc","serverTimestamp","db","auth","format","differenceInDays","Chart","jsx","_jsx","jsxs","_jsxs","OverallDashboard","clients","setClients","selectedClient","setSelectedClient","rbts","setRbts","filtered","setFiltered","loading","setLoading","userRole","setUserRole","filters","setFilters","site","running_status","breakdown_status","work","from","to","chartRef","runningStatusOptions","value","label","breakdownStatusOptions","workOptions","fetchRole","user","currentUser","email","endsWith","fetchClients","snapshot","docs","map","id","data","err","console","error","interval","fetchAllRBTs","sitesSnapshot","allRbts","siteDoc","siteName","rbtsSnapshot","siteRbts","docItem","_rbt$last_updated","_rbt$last_updated$toD","rbt","lastUpdated","last_updated","toDate","call","rbt_id","running_status_ageing","Math","max","Date","setInterval","clearInterval","result","filter","fromDate","isNaN","ctx","document","getElementById","current","destroy","counts","Auto","Manual","forEach","hasOwnProperty","type","labels","Object","keys","datasets","values","borderColor","backgroundColor","tension","fill","options","responsive","plugins","tooltip","enabled","legend","display","scales","y","beginAtZero","title","text","x","handleFilterChange","e","prev","target","name","handleExportCSV","headers","rows","escapeCSV","val","String","replace","csvContent","row","join","blob","Blob","url","URL","createObjectURL","link","createElement","href","setAttribute","now","body","appendChild","click","removeChild","handleEditField","rbtId","field","ref","updateData","r","totalRBTs","length","autoCount","manualCount","notRunningCount","className","children","onChange","client","Array","Set","v","opt","onClick","height"],"sources":["C:/Users/mis/rbt-dashboard/src/pages/OverallDashboard.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { collection, getDocs, doc, updateDoc, serverTimestamp } from \"firebase/firestore\";\r\nimport { db, auth } from \"../firebase\";\r\nimport { format, differenceInDays } from \"date-fns\";\r\nimport Chart from \"chart.js/auto\";\r\n\r\nconst OverallDashboard = () => {\r\n    const [clients, setClients] = useState([]);\r\n    const [selectedClient, setSelectedClient] = useState(\"\");\r\n    const [rbts, setRbts] = useState([]);\r\n    const [filtered, setFiltered] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [userRole, setUserRole] = useState(\"user\");\r\n    const [filters, setFilters] = useState({\r\n        site: \"\",\r\n        running_status: \"\",\r\n        breakdown_status: \"\",\r\n        work: \"\",\r\n        from: \"\",\r\n        to: \"\",\r\n    });\r\n\r\n    const chartRef = useRef(null);\r\n\r\n    const runningStatusOptions = [\r\n        { value: \"Auto\", label: \"Auto\" },\r\n        { value: \"Manual\", label: \"Manual\" },\r\n        { value: \"Not Running\", label: \"Not Running\" },\r\n        { value: \"N/A\", label: \"N/A\" }\r\n    ];\r\n\r\n    const breakdownStatusOptions = [\r\n        { value: \"Breakdown\", label: \"Breakdown\" },\r\n        { value: \"Running With Issue\", label: \"Running With Issue\" },\r\n        { value: \"N/A\", label: \"N/A\" }\r\n    ];\r\n\r\n    const workOptions = [\r\n        { value: \"Part Installation\", label: \"Part Installation\" },\r\n        { value: \"Part Testing\", label: \"Part Testing\" },\r\n        { value: \"Trial\", label: \"Trial\" },\r\n        { value: \"Auto Scheduling\", label: \"Auto Scheduling\" },\r\n        { value: \"N/A\", label: \"N/A\" }\r\n    ];\r\n\r\n    // ✅ Fetch user role\r\n    useEffect(() => {\r\n        const fetchRole = () => {\r\n            const user = auth.currentUser;\r\n            if (!user || !user.email) return;\r\n            if (user.email === \"dev@brightbots.in\") setUserRole(\"super_admin\");\r\n            else if (user.email.endsWith(\"@brightbots.in\")) setUserRole(\"admin\");\r\n            else setUserRole(\"user\");\r\n        };\r\n        fetchRole();\r\n    }, []);\r\n\r\n    // ✅ Fetch all clients\r\n    useEffect(() => {\r\n        const fetchClients = async () => {\r\n            try {\r\n                const snapshot = await getDocs(collection(db, \"clients\"));\r\n                setClients(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));\r\n            } catch (err) {\r\n                console.error(\"Error fetching clients:\", err);\r\n            }\r\n        };\r\n        fetchClients();\r\n    }, []);\r\n\r\n    // ✅ Fetch all RBTs for selected client\r\n    useEffect(() => {\r\n        if (!selectedClient) return;\r\n\r\n        let interval;\r\n        const fetchAllRBTs = async () => {\r\n            try {\r\n                setLoading(true);\r\n                const sitesSnapshot = await getDocs(collection(db, \"clients\", selectedClient, \"sites\"));\r\n                let allRbts = [];\r\n\r\n                for (const siteDoc of sitesSnapshot.docs) {\r\n                    const siteName = siteDoc.id;\r\n                    const rbtsSnapshot = await getDocs(collection(db, \"clients\", selectedClient, \"sites\", siteName, \"rbts\"));\r\n\r\n                    const siteRbts = rbtsSnapshot.docs.map(docItem => {\r\n                        const rbt = docItem.data() || {};\r\n                        const lastUpdated = rbt?.last_updated?.toDate?.() || null;\r\n                        return {\r\n                            id: docItem.id,\r\n                            rbt_id: docItem.id,\r\n                            site: siteName,\r\n                            ...rbt,\r\n                            running_status: rbt.running_status || \"N/A\",\r\n                            breakdown_status: rbt.breakdown_status || \"N/A\",\r\n                            work: rbt.work || \"N/A\",\r\n                            last_updated: lastUpdated,\r\n                            running_status_ageing:\r\n                                rbt.running_status === \"Auto\"\r\n                                    ? 0\r\n                                    : lastUpdated\r\n                                        ? Math.max(differenceInDays(new Date(), lastUpdated), 0)\r\n                                        : \"-\"\r\n                        };\r\n                    });\r\n\r\n                    allRbts = [...allRbts, ...siteRbts];\r\n                }\r\n\r\n                setRbts(allRbts);\r\n                setFiltered(allRbts);\r\n            } catch (error) {\r\n                console.error(\"Error fetching RBTs:\", error);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchAllRBTs();\r\n        interval = setInterval(fetchAllRBTs, 30000);\r\n\r\n        return () => clearInterval(interval);\r\n    }, [selectedClient]);\r\n\r\n    // ✅ Apply filters\r\n    useEffect(() => {\r\n        let result = [...rbts];\r\n\r\n        if (filters.site) result = result.filter((rbt) => rbt.site === filters.site);\r\n        if (filters.running_status) result = result.filter((rbt) => rbt.running_status === filters.running_status);\r\n        if (filters.breakdown_status) result = result.filter((rbt) => rbt.breakdown_status === filters.breakdown_status);\r\n        if (filters.work) result = result.filter((rbt) => rbt.work === filters.work);\r\n\r\n        if (filters.from) {\r\n            const fromDate = new Date(filters.from);\r\n            if (!isNaN(fromDate)) result = result.filter((rbt) => rbt.last_updated && rbt.last_updated >= fromDate);\r\n        }\r\n\r\n        if (filters.to) {\r\n            const toDate = new Date(filters.to);\r\n            if (!isNaN(toDate)) result = result.filter((rbt) => rbt.last_updated && rbt.last_updated <= toDate);\r\n        }\r\n\r\n        setFiltered(result);\r\n    }, [filters, rbts]);\r\n\r\n    // ✅ Chart updates\r\n    useEffect(() => {\r\n        const ctx = document.getElementById(\"statusChart\");\r\n        if (!ctx) return;\r\n\r\n        if (chartRef.current) chartRef.current.destroy();\r\n\r\n        const counts = { Auto: 0, Manual: 0, \"Not Running\": 0 };\r\n        filtered.forEach((rbt) => {\r\n            if (counts.hasOwnProperty(rbt.running_status)) counts[rbt.running_status]++;\r\n        });\r\n\r\n        chartRef.current = new Chart(ctx, {\r\n            type: \"line\",\r\n            data: {\r\n                labels: Object.keys(counts),\r\n                datasets: [\r\n                    {\r\n                        label: \"Running Status\",\r\n                        data: Object.values(counts),\r\n                        borderColor: \"#2563eb\",\r\n                        backgroundColor: \"rgba(37, 99, 235, 0.3)\",\r\n                        tension: 0.4,\r\n                        fill: true,\r\n                    },\r\n                ],\r\n            },\r\n            options: {\r\n                responsive: true,\r\n                plugins: { tooltip: { enabled: true }, legend: { display: false } },\r\n                scales: {\r\n                    y: { beginAtZero: true, title: { display: true, text: \"No. of RBTs\" } },\r\n                    x: { title: { display: true, text: \"Running Status\" } },\r\n                },\r\n            },\r\n        });\r\n    }, [filtered]);\r\n\r\n    const handleFilterChange = (e) => setFilters((prev) => ({ ...prev, [e.target.name]: e.target.value }));\r\n\r\n    const handleExportCSV = () => {\r\n        const headers = [\"Site\", \"RBT\", \"Running Status\", \"Breakdown Status\", \"Work\", \"Ageing\", \"Last Updated\"];\r\n        const rows = filtered.map((rbt) => [\r\n            rbt.site,\r\n            rbt.rbt_id,\r\n            rbt.running_status,\r\n            rbt.breakdown_status,\r\n            rbt.work,\r\n            rbt.running_status_ageing,\r\n            rbt.last_updated ? format(rbt.last_updated, \"yyyy-MM-dd HH:mm\") : \"-\",\r\n        ]);\r\n\r\n        const escapeCSV = (val) => `\"${String(val || \"\").replace(/\"/g, '\"\"')}\"`;\r\n        const csvContent = [headers, ...rows].map((row) => row.map(escapeCSV).join(\",\")).join(\"\\n\");\r\n        const blob = new Blob([csvContent], { type: \"text/csv;charset=utf-8;\" });\r\n        const url = URL.createObjectURL(blob);\r\n\r\n        const link = document.createElement(\"a\");\r\n        link.href = url;\r\n        link.setAttribute(\"download\", `RBT_Dashboard_${Date.now()}.csv`);\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n    };\r\n\r\n    const handleEditField = async (rbtId, site, field, value) => {\r\n        try {\r\n            const ref = doc(db, \"clients\", selectedClient, \"sites\", site, \"rbts\", rbtId);\r\n            const now = new Date();\r\n\r\n            const updateData = { [field]: String(value), last_updated: serverTimestamp() };\r\n\r\n            if (field === \"running_status\") {\r\n                updateData.running_status_ageing = value === \"Auto\" ? 0 : 0;\r\n            }\r\n\r\n            await updateDoc(ref, updateData);\r\n\r\n            setRbts((prev) =>\r\n                prev.map((r) =>\r\n                    r.id === rbtId\r\n                        ? {\r\n                            ...r,\r\n                            ...updateData,\r\n                            last_updated: now,\r\n                            running_status_ageing: field === \"running_status\" ? (value === \"Auto\" ? 0 : 0) : r.running_status_ageing,\r\n                        }\r\n                        : r\r\n                )\r\n            );\r\n        } catch (error) {\r\n            console.error(\"Error updating field:\", error);\r\n        }\r\n    };\r\n\r\n    const totalRBTs = filtered.length;\r\n    const autoCount = filtered.filter((r) => r.running_status === \"Auto\").length;\r\n    const manualCount = filtered.filter((r) => r.running_status === \"Manual\").length;\r\n    const notRunningCount = filtered.filter((r) => r.running_status === \"Not Running\").length;\r\n\r\n    return (\r\n        <div className=\"p-6\">\r\n            <h1 className=\"text-2xl font-bold mb-6\">📊 Overall RBT Dashboard</h1>\r\n\r\n            {/* CLIENT SELECTOR */}\r\n            <div className=\"mb-4\">\r\n                <select value={selectedClient} onChange={(e) => setSelectedClient(e.target.value)} className=\"border p-2 rounded-md\">\r\n                    <option value=\"\">Select Client</option>\r\n                    {clients.map((client) => (\r\n                        <option key={client.id} value={client.id}>{client.id}</option>\r\n                    ))}\r\n                </select>\r\n            </div>\r\n\r\n            {/* SUMMARY */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\r\n                <div className=\"bg-blue-100 p-4 rounded shadow text-center\">\r\n                    <h2 className=\"text-lg font-semibold\">Total RBTs</h2>\r\n                    <p className=\"text-2xl font-bold\">{totalRBTs}</p>\r\n                </div>\r\n                <div className=\"bg-green-100 p-4 rounded shadow text-center\">\r\n                    <h2 className=\"text-lg font-semibold\">Auto</h2>\r\n                    <p className=\"text-2xl font-bold\">{autoCount}</p>\r\n                </div>\r\n                <div className=\"bg-yellow-100 p-4 rounded shadow text-center\">\r\n                    <h2 className=\"text-lg font-semibold\">Manual</h2>\r\n                    <p className=\"text-2xl font-bold\">{manualCount}</p>\r\n                </div>\r\n                <div className=\"bg-red-100 p-4 rounded shadow text-center\">\r\n                    <h2 className=\"text-lg font-semibold\">Not Running</h2>\r\n                    <p className=\"text-2xl font-bold\">{notRunningCount}</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* FILTERS */}\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\r\n                <select name=\"site\" value={filters.site} onChange={handleFilterChange} className=\"border p-2 rounded-md\">\r\n                    <option value=\"\">Filter by Site</option>\r\n                    {Array.from(new Set(rbts.map((rbt) => rbt.site)))\r\n                        .filter((v) => v)\r\n                        .map((val) => (\r\n                            <option key={val} value={val}>{val}</option>\r\n                        ))}\r\n                </select>\r\n\r\n                <select name=\"running_status\" value={filters.running_status} onChange={handleFilterChange} className=\"border p-2 rounded-md\">\r\n                    <option value=\"\">Filter by Running Status</option>\r\n                    {runningStatusOptions.map((opt) => (\r\n                        <option key={opt.value} value={opt.value}>{opt.label}</option>\r\n                    ))}\r\n                </select>\r\n\r\n                <select name=\"breakdown_status\" value={filters.breakdown_status} onChange={handleFilterChange} className=\"border p-2 rounded-md\">\r\n                    <option value=\"\">Filter by Breakdown Status</option>\r\n                    {breakdownStatusOptions.map((opt) => (\r\n                        <option key={opt.value} value={opt.value}>{opt.label}</option>\r\n                    ))}\r\n                </select>\r\n\r\n                <select name=\"work\" value={filters.work} onChange={handleFilterChange} className=\"border p-2 rounded-md\">\r\n                    <option value=\"\">Filter by Work</option>\r\n                    {workOptions.map((opt) => (\r\n                        <option key={opt.value} value={opt.value}>{opt.label}</option>\r\n                    ))}\r\n                </select>\r\n\r\n                <input type=\"date\" name=\"from\" value={filters.from} onChange={handleFilterChange} className=\"border p-2 rounded-md\" />\r\n                <input type=\"date\" name=\"to\" value={filters.to} onChange={handleFilterChange} className=\"border p-2 rounded-md\" />\r\n            </div>\r\n\r\n            {/* EXPORT */}\r\n            <div className=\"mb-4\">\r\n                <button onClick={handleExportCSV} className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\">\r\n                    Export CSV\r\n                </button>\r\n            </div>\r\n\r\n            {/* CHART */}\r\n            <div className=\"w-2/4 mx-auto mb-10 transition-transform duration-300 hover:scale-110\">\r\n                <canvas id=\"statusChart\" height=\"200\"></canvas>\r\n            </div>\r\n\r\n            {/* TABLE */}\r\n            {loading ? (\r\n                <p>Loading RBT data...</p>\r\n            ) : (\r\n                <div className=\"overflow-x-auto\">\r\n                    <table className=\"min-w-full bg-white shadow-md rounded-lg\">\r\n                        <thead>\r\n                            <tr className=\"bg-gray-200 text-gray-600 uppercase text-sm\">\r\n                                <th className=\"py-3 px-4 text-left\">Site</th>\r\n                                <th className=\"py-3 px-4 text-left\">RBT</th>\r\n                                <th className=\"py-3 px-4 text-left\">Running</th>\r\n                                <th className=\"py-3 px-4 text-left\">Breakdown</th>\r\n                                <th className=\"py-3 px-4 text-left\">Work</th>\r\n                                <th className=\"py-3 px-4 text-left\">Ageing</th>\r\n                                <th className=\"py-3 px-4 text-left\">Last Updated</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody className=\"text-gray-700 text-sm\">\r\n                            {filtered.map((rbt) => (\r\n                                <tr key={rbt.id} className=\"border-b border-gray-200 hover:bg-gray-100\">\r\n                                    <td className=\"py-2 px-4\">{rbt.site}</td>\r\n                                    <td className=\"py-2 px-4\">{rbt.rbt_id}</td>\r\n                                    {[\"running_status\", \"breakdown_status\", \"work\"].map((field) => (\r\n                                        <td key={field} className=\"py-2 px-4\">\r\n                                            {userRole === \"admin\" || userRole === \"super_admin\" ? (\r\n                                                <select\r\n                                                    value={rbt[field] || \"N/A\"}\r\n                                                    onChange={(e) => handleEditField(rbt.id, rbt.site, field, e.target.value)}\r\n                                                    className=\"border p-1 rounded\"\r\n                                                >\r\n                                                    {field === \"running_status\" &&\r\n                                                        runningStatusOptions.map((opt) => <option key={opt.value} value={opt.value}>{opt.label}</option>)}\r\n                                                    {field === \"breakdown_status\" &&\r\n                                                        breakdownStatusOptions.map((opt) => <option key={opt.value} value={opt.value}>{opt.label}</option>)}\r\n                                                    {field === \"work\" &&\r\n                                                        workOptions.map((opt) => <option key={opt.value} value={opt.value}>{opt.label}</option>)}\r\n                                                </select>\r\n                                            ) : (\r\n                                                rbt[field] || \"N/A\"\r\n                                            )}\r\n                                        </td>\r\n                                    ))}\r\n                                    <td className=\"py-2 px-4 text-center\">{rbt.running_status_ageing}</td>\r\n                                    <td className=\"py-2 px-4\">{rbt.last_updated ? format(rbt.last_updated, \"yyyy-MM-dd HH:mm\") : \"-\"}</td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default OverallDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}